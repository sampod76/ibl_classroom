services:
  client_classroom:
    # Production build from your Dockerfile (runner stage)
    build:
      context: .
      dockerfile: Dockerfile
      target: runner
    container_name: classroom
    env_file:
      - .env.production
    environment:
      NODE_ENV: "production"
      PORT: "3001" # must match Dockerfile runner
      HOSTNAME: "0.0.0.0"
    ports:
      - "3001:3001" # host:container â†’ http://localhost:3001
    restart: unless-stopped
    # Use Node-based healthcheck so no curl/wget dependency is needed
    # healthcheck:
    #   test:
    #     [
    #       "CMD-SHELL",
    #       'node -e "require(''http'').get(''http://localhost:3001/'',res=>process.exit(res.statusCode>=200&&res.statusCode<500?0:1)).on(''error'',()=>process.exit(1))"',
    #     ]
    #   interval: 60s
    #   timeout: 5s
    #   retries: 10
# docker compose up -d --build --remove-orphans client_classroom
#
